　<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>きゃたんのビンゴゲーム</title>
  
  <link rel="icon" href="IMG_4666.png" type="image/png">
  <meta property="og:image" content="https://www.yourwebsite.com/無題12_20250907003655.jpeg">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">

  <link rel="stylesheet" href="common.css">

</head>

<body>
  <div id="header-placeholder"></div>

  <main>
    <section id="bingo">
      <h3>📢 抽選結果 📢</h3>

      <div id="bingoDisplay">
        <p style="font-size: 1.2rem; margin-bottom: 0.5rem; color: #5aa2aa;">現在の表示番号</p>
        <div id="latestNumber">--</div>

        <h4 style="color: #1b656f; border-bottom: 1px solid #ccc; padding-bottom: 0.3rem; margin-top: 2rem;">出た番号一覧 (1〜75)</h4>
        <div id="numberBoard">
          </div>
      </div>
    </section>
  </main>

  <div id="footer-placeholder"></div>

  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>

  <script src="common.js"></script>

  <script>
    // ----------------------------------------------------------------------
    // 🎨 Firebase設定
    // ----------------------------------------------------------------------
    const firebaseConfig = {
      apiKey: "AIzaSyBWaCw2nAEh6FbYbteNk_fBSqPBTZ_UhC8",
      authDomain: "catiffanygame.firebaseapp.com",
      databaseURL: "https://catiffanygame-default-rtdb.firebaseio.com",
      projectId: "catiffanygame",
      storageBucket: "catiffanygame.firebasestorage.app",
      messagingSenderId: "166871605809",
      appId: "1:166871605809:web:1fe6e874fa06005ec46b10",
      measurementId: "G-ZNGEZZWMTP"
    };

    // Firebase初期化とデータベース参照の取得
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const bingoRef = db.ref('bingo'); // /bingo 全体を監視

    const maxNumber = 75;
    const latestNumberEl = document.getElementById('latestNumber');
    const numberBoardEl = document.getElementById('numberBoard');

    // ボードの描画処理 (常に10個/行、Flexbox対応)
    function renderBoard(drawnNumbers, currentDisplay) {
        // --- 最新表示の更新 ---
        latestNumberEl.textContent = currentDisplay !== '--' ? currentDisplay : '--';
        
        // 抽選中かどうかを判断し、表示に反映
        const isDrawing = !drawnNumbers.includes(parseInt(currentDisplay)) && currentDisplay !== '--';
        
        if (isDrawing) {
            latestNumberEl.classList.add('drawing');
        } else {
            latestNumberEl.classList.remove('drawing');
        }

        // --- ボードの更新 ---
        numberBoardEl.innerHTML = '';
        
        for (let i = 1; i <= maxNumber; i++) {
            const cell = document.createElement('div');
            cell.className = 'bingo-cell';
            cell.setAttribute('data-content', i);
            
            // 抽選済みの数字ならスタイルを適用
            if (drawnNumbers.includes(i)) {
                cell.classList.add('drawn');
            }
            
            numberBoardEl.appendChild(cell);

            // 10個ごとに改行要素を挿入 (11個目が2行目になるように)
            if (i % 10 === 0 && i < maxNumber) {
                const breakEl = document.createElement('div');
                breakEl.className = 'break';
                numberBoardEl.appendChild(breakEl);
            }
        }
    }

    // Firebaseのデータ変更をリアルタイムで監視し、画面を自動更新
    bingoRef.on('value', (snapshot) => {
        const data = snapshot.val() || {};
        const drawnNumbers = data.drawnNumbers || [];
        const currentDisplay = data.currentDisplay || '--'; 

        renderBoard(drawnNumbers, currentDisplay);
        console.log("Firebaseから最新のデータを受信しました。");
    }, (error) => {
        console.error("Firebaseからのデータ受信エラー:", error);
    });
    
    document.addEventListener("DOMContentLoaded", () => {
        // ★ 共通JSの setupHeader 関数を呼び出してヘッダー/フッターを読み込む ★
        // 参加者ページなので 'header-user.html' を指定
        setupHeader('header-user.html');
        
        // 元のHTMLにあったハンバーガーメニューのJSロジックはcommon.jsのsetupHeader()内に統合されました。
    });

  </script>
</body>

</html>
