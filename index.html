<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ルーレットを止める</title>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
  <script>
    // Firebase 初期化（すでに使っている設定に置き換えて）
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      databaseURL: "https://YOUR_PROJECT_ID.firebaseio.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "SENDER_ID",
      appId: "APP_ID"
    };
    firebase.initializeApp(firebaseConfig);
  </script>
</head>
<body>
  <h1>ルーレットを止めるページ</h1>

  <div id="content" style="display: none;">
    <label>あいことばを入力してください：</label><br>
    <input type="text" id="keyword" />
    <button onclick="checkKeyword()">送信</button>
    <p id="error" style="color: red;"></p>
    <div id="stopSection" style="display: none; margin-top: 1em;">
      <button onclick="stopRoulette()" style="font-size: 1.2em;">🛑 ルーレットを止める</button>
    </div>
  </div>

  <script>
    const correctKeyword = "ねこ"; // ← 合言葉（自由に変えてOK）

    // spinningの状態を確認して、回ってるときだけフォーム表示
    firebase.database().ref("roulette/spinning").on("value", (snapshot) => {
      if (snapshot.val() === true) {
        document.getElementById("content").style.display = "block";
      } else {
        document.body.innerHTML = "<h2>現在ルーレットは回っていません。</h2>";
      }
    });

    function checkKeyword() {
      const input = document.getElementById("keyword").value.trim();
      if (input === correctKeyword) {
        document.getElementById("stopSection").style.display = "block";
        document.getElementById("error").textContent = "";
      } else {
        document.getElementById("error").textContent = "合言葉が違います。";
      }
    }

    function stopRoulette() {
      firebase.database().ref("roulette/spinning").set(false).then(() => {
        alert("ルーレットを停止しました！");
        window.location.href = "index.html";
      });
    }
  </script>
</body>
</html>